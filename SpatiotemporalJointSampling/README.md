# 时空联合采样

## 系统建模与定义

### 状态变量与动力学模型

本模型定义了两类状态变量，分别用于机器人状态观测和轨迹预测：

• 可观测状态：$\mathbf{h} = (x, y, \theta, v, \omega)^T$

• 预测轨迹状态：$\mathbf{s} = (x, y, v_x, v_y)^T$

• 控制输入：$\mathbf{u} = (a_x, a_y)$

其中，$(x, y)$ 表示机器人在全局坐标系下的位置，$\theta$ 为航向角，$v$ 和 $\omega$ 分别为线速度和角速度，$v_x$ 和 $v_y$ 是线速度在 $x$ 和 $y$ 方向的分量，$a_x$ 和 $a_y$ 是加速度分量。

系统动力学采用匀加速直线运动模型：

$$
\mathbf{s}(s_0,a_x,a_y,t) = \begin{pmatrix}
x_0 + v_x t + \frac{1}{2}a_x t^2 \\
y_0 + v_y t + \frac{1}{2}a_y t^2 \\
v_{x_0} + a_x t \\
v_{y_0} + a_y t
\end{pmatrix}
$$

### 均匀网格采样

控制集 `C` 通过离散化加速度空间生成：

$$

$$

其中，`A` 是最大加速度绝对值，`N` 是每个方向的采样点数

这种采样策略将连续的优化问题转化为离散的评估问题，虽然可能丢失最优解，但保证了实时性

参数 `A` 和 `N` 的选取需要平衡规划性能和控制精度：

- 较大的 `A` 值允许更激进的运动，但可能导致轨迹不平滑

- 较大的N值提高控制精度，但计算量随 `N^2` 增长


### 时间序列与同步机制

为了实现对动态环境的精确响应，本模型引入明确的时间序列和同步机制，

确保机器人的轨迹预测与障碍物的运动预测在时间轴上完全对齐

我们定义预测时域为一段未来的时间区间 $[0, T]$ 。在该时域内，

以均匀的时间间隔 $\Delta t = T/K$ 设置 $K+1$ 个采样点，构成一个离散的时间序列：

$$
\mathcal{T} = \left\{ 0, \frac{T}{K}, 2\frac{T}{K}, \ldots, T \right\}
$$

其中，`T` 表示预测时域的长度，它同时是机器人前向仿真的时长以及动态障碍物轨迹预测的时长。`K` 是一个正整数，决定了时间采样的分辨率

基于此时间序列，对于任意一个控制对 $\mathbf{u} = (a_x, a_y) \in C$ 和初始状态 $\mathbf{s}_0$，在时刻 $t_k = k \frac{T}{K}$ 的预测状态 $\mathbf{s}_i(k)$ 由动力学模型精确计算：

$$
\mathbf{s}_i(k) = \mathbf{s} \left( \mathbf{s}_0, a_x, a_y, k \frac{T}{K} \right)
$$

所有控制对生成的所有轨迹点构成了完整的预测轨迹集合 ${\mathcal{S}}=\{s_i(\mathcal{T})\}_{i=0}^{N\cdot N}$

时间同步的核心价值 在于，它使得在每一个相同的未来时刻 $t_k$ ，我们可以将机器人的预测位置 $[s_i(k).x, s_i(k).y]$ 与动态障碍物 $\mathcal{O}$ 在同一时刻的预测位置 $\mathbf{o}_{o}^p(k)$ 进行同步的碰撞风险评估。


